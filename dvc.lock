schema: '2.0'
stages:
  download_dataset:
    cmd: python scripts/download.py hydra.run.dir="data" &>logs/download.out
    deps:
    - path: scripts/download.py
      md5: 640e95086f360db889872bb7344733b7
      size: 758
    outs:
    - path: ./data/raw
      md5: 174fe7fcb400140a007ac05c36b5bfd4.dir
      size: 68556316
      nfiles: 3001
    - path: logs/download.out
      md5: 2affde5103721cd5087fb990c41d3261
      size: 611
  preprocess:
    cmd: python scripts/preprocess.py  &> logs/preprocess.out
    deps:
    - path: ./data/raw
      md5: 174fe7fcb400140a007ac05c36b5bfd4.dir
      size: 68556316
      nfiles: 3001
    - path: scripts/preprocess.py
      md5: 50833941e6156b8c22be5055dc488ceb
      size: 1654
    outs:
    - path: ./data/dataset/test
      md5: c086811c9b987745c1b2135b3b623c69.dir
      size: 6612162
      nfiles: 291
    - path: ./data/dataset/train
      md5: 0a1a83aa537b94b2b07eb1503701eca7.dir
      size: 45613376
      nfiles: 2000
    - path: ./data/dataset/val
      md5: 0057b514e96ee08fefcdb437a6373237.dir
      size: 16330638
      nfiles: 709
    - path: logs/preprocess.out
      md5: c16121ff2b1fe8974a772b784d7007dd
      size: 1384
  train:
    cmd: python scripts/train2.py
    deps:
    - path: ./data/dataset/train
      md5: 0a1a83aa537b94b2b07eb1503701eca7.dir
      size: 45613376
      nfiles: 2000
    - path: ./data/dataset/val
      md5: 0057b514e96ee08fefcdb437a6373237.dir
      size: 16330638
      nfiles: 709
    - path: scripts/train2.py
      md5: 815199902184168c09d9b26c003cd51f
      size: 3414
    params:
      params.yaml:
        train:
          batch_size: 32
          img_size:
          - 160
          - 160
          learning_rate: 0.0001
          subdir:
            train: train
            valid: valid
            test: test
          epochs: 4
          activation: relu
          n_channels: 32
    outs:
    - path: ./data/train/best_weights.h5
      md5: 09bf82d4f8e1ec203408b32586935f7b
      size: 39663720
    - path: ./data/train/model
      md5: 89209bfb682d09523f8a687059491610.dir
      size: 40109583
      nfiles: 4
    - path: ./data/train/training_metrics
      md5: 2ad1ffebd1076c5a16e5bc3064a1e5cd.dir
      size: 674
      nfiles: 4
  evaluate:
    cmd: python scripts/eval.py
    deps:
    - path: ./data/dataset/test
      md5: c086811c9b987745c1b2135b3b623c69.dir
      size: 6612162
      nfiles: 291
    - path: ./data/train/model
      md5: 89209bfb682d09523f8a687059491610.dir
      size: 40109583
      nfiles: 4
    - path: scripts/eval.py
      md5: 1ac7a5be1c0b600343c1ca64bc6bfe19
      size: 3060
    outs:
    - path: ./data/eval/metrics.json
      md5: 19a9284938ab41c353f2e3cb782d26c2
      size: 56
    - path: ./data/eval/prc.json
      md5: 1873746a5f3ed0ddf379a4ef7e61bc0f
      size: 43336
    - path: ./data/eval/predictions.csv
      md5: 1124d0270a65d94e2976f08b6f576349
      size: 24939
    - path: ./data/eval/roc.json
      md5: 0ba07220482567bb44e606a866ee35e9
      size: 17446
